<html><body>
<script src='matter.js' type='text/javascript'></script>
<script>

  var Engine = Matter.Engine,
      Events = Matter.Events,
      Render = Matter.Render,
      Runner = Matter.Runner,
      Body = Matter.Body,
      Composite = Matter.Composite,
      Composites = Matter.Composites,
      Constraint = Matter.Constraint,
      MouseConstraint = Matter.MouseConstraint,
      Mouse = Matter.Mouse,
      World = Matter.World,
      Bodies = Matter.Bodies,
      Vector = Matter.Vector;

  // create engine
  var engine = Engine.create(),
      world = engine.world;

  // create renderer
  var render = Render.create({
      element: document.body,
      engine: engine,
      options: {
          width: 800,
          height: 600,
          wireframes: false,
          background: '#0f0f13'
      }
  });

  Render.run(render);

  // create runner
  var runner = Runner.create();
  Runner.run(runner, engine);

  var baseLength = 100;
  var baseWidth  = 20;
  // add bodies
  var group = Body.nextGroup(true);
  
  var base = Bodies.rectangle(350, 500, baseLength*1.5, baseWidth, { 
      collisionFilter: { group: group },
      frictionAir: 0,
      chamfer: 5,
      render: {
          fillStyle: 'transparent',
          lineWidth: 4,
	  strokeStyle: "#fa485b"
      }
  });

  var leg = Bodies.rectangle(350, 500-baseLength/2, baseLength, baseWidth, { 
      collisionFilter: { group: group },
      frictionAir: 0,
      chamfer: 5,
      render: {
          fillStyle: 'transparent',
          lineWidth: 4,
	  strokeStyle: "#4af85b"
      }
  });

  var torso = Bodies.rectangle(300, 500-baseLength, baseLength, baseWidth, { 
      collisionFilter: { group: group },
      frictionAir: 0,
      chamfer: 5,
      render: {
          fillStyle: 'transparent',
          lineWidth: 4,
	  strokeStyle: "#4a48fb"
      }
  });

  var head = Bodies.rectangle(350, 350, 2*baseWidth, 2*baseWidth, { 
      collisionFilter: { group: group },
      frictionAir: 0,
      chamfer: 5,
      render: {
          fillStyle: 'transparent',
          lineWidth: 4,
	  strokeStyle: "#faf8fb"
      }
  });

  head.mass *= 2.0;
  base.mass *= 10.0;

  var stuckBleft = Constraint.create({ 
      bodyB: base,
      pointB: { x: -baseLength * 0.84, y: 0 },
      pointA: { x: base.position.x - baseLength * 0.84,
		y: base.position.y },
      stiffness: 0.1,
      length: 0,
      render: {
          strokeStyle: '#4a48fb'
      }
  });

  var stuckBright = Constraint.create({ 
      bodyB: base,
      pointB: { x: +baseLength * 0.84, y: 0 },
      pointA: { x: base.position.x + baseLength * 0.84,
		y: base.position.y },
      stiffness: 0.1,
      length: 0,
      render: {
          strokeStyle: '#4a48fb'
      }
  });

  var stuckLtoB = Constraint.create({
      bodyB: base,
      pointB: { x: 0, y: 0 },
      bodyA: leg,
      pointA: { x: -baseLength/2,
                y: 0 },
      stiffness: 1,
      length: 0,
      render: {
          strokeStyle: '#4a48fb'
      }
  });

  var stuckTtoL = Constraint.create({
      bodyB: torso,
      pointB: { x: -baseLength/2, y: 0 },
      bodyA: leg,
      pointA: { x: +baseLength/2,
                y: 0 },
      stiffness: 1,
      length: 0,
      render: {
          strokeStyle: '#4a48fb'
      }
  });

  var stuckHtoT = Constraint.create({
      bodyB: head,
      pointB: { x: -baseWidth, y: 0 },
      bodyA: torso,
      pointA: { x: baseLength/2,
                y: 0 },
      stiffness: 1,
      length: 0,
      render: {
          strokeStyle: '#4a48fb'
      }
  });

  var muscle = Constraint.create({
      bodyB: base,
      pointB: { x: -baseLength/2, y: 0 },
      bodyA: leg,
      pointA: { x: 0,
                y: 0 },
      stiffness: 0.8,
      length: baseLength*Math.sqrt(3)/6,
      render: {
          strokeStyle: '#4a48fb'
      }
  });

  var core = Constraint.create({
      bodyB: torso,
      pointB: { x: 0, y: 0 },
      bodyA: leg,
      pointA: { x: 0, y: 0 },
      stiffness: 0.99,
      length: baseLength/2,
      render: {
          strokeStyle: '#4a48fb'
      }
  });

  var neck = Constraint.create({
      bodyB: head,
      pointB: { x: -5, y: -5 },
      bodyA: torso,
      pointA: { x: baseLength/2, y: -5},
      stiffness: 1,
      length: 5,
      render: {
          strokeStyle: '#4a48fb'
      }
  });

  Body.rotate(leg, -Math.PI * 0.25, {
      x: leg.position.x - baseLength/4,
      y: leg.position.y
  });

  world.gravity.scale = 0.004;
  
  World.add(world, base);
  World.add(world, leg);
  World.add(world, torso);
  World.add(world, head);
  World.add(world, stuckBleft);
  World.add(world, stuckBright);
  World.add(world, stuckLtoB);
  World.add(world, stuckTtoL);
  World.add(world, stuckHtoT);
  World.add(world, muscle);
  World.add(world, core);
  World.add(world, neck);

  var muscleLength = muscle.length;
  var muscleDelta = muscleLength/12;
  var muscleStep = 0.0;
  var muscleTwitch = 0.02;
  
  var neckLength = neck.length;
  var neckDelta = neck.length*0.1;
  var neckStep = 0.0;
  var neckTwitch = 0.1;

  
      
  Events.on(render, 'afterRender', function() {
      muscle.length = muscleLength + muscleDelta/2*Math.sin(2*muscleStep+Math.PI/3) + muscleDelta * Math.sin(muscleStep);
      muscleStep += muscleTwitch;
      neck.length = neckLength + neckDelta * Math.sin(neckStep);
      neckStep += neckTwitch;
  });

  // add mouse control
  var mouse = Mouse.create(render.canvas),
      mouseConstraint = MouseConstraint.create(engine, {
          mouse: mouse,
          constraint: {
              stiffness: 0.9,
              render: {
                  visible: false
              }
          }
      });

  World.add(world, mouseConstraint);

  // keep the mouse in sync with rendering
  render.mouse = mouse;

  // fit the render viewport to the scene
  Render.lookAt(render, {
      min: { x: 0, y: 0 },
      max: { x: 700, y: 600 }
  });

 
</script>
</body></html>

